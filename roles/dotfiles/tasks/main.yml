---
- name: "Clone dotfiles for {{ dotfiles_user }}"
  become: true
  become_user: "{{ dotfiles_user }}"
  git:
    repo: "{{ dotfiles_repo }}"
    dest: "{{ dotfiles_path }}"
    bare: yes
- name: "Checkout dotfiles repo for {{ dotfiles_user }}"
  become: true
  become_user: "{{ user.name }}"
  shell: "/usr/bin/git --git-dir=$HOME/.dotfiles.git/ --work-tree=$HOME checkout"
  args:
    chdir: "{{ dotfiles_home }}"
    creates: "{{ dotfiles_home }}/.zshrc"
  notify: disable status.showUntrackedFiles for dotfiles repo
